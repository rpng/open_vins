<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ov_msckf::UpdaterHelper class | OpenVINS</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600&amp;subset=latin-ext" />
  <link rel="stylesheet" href="m-udel+documentation.compiled.css" />
  <link rel="stylesheet" href="custom.css" />
  <link rel="icon" href="favicon-light.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#2f73a3" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">OpenVINS</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="namespaceov__core.html">ov_core</a></li>
            <li><a href="namespaceov__eval.html">ov_eval</a></li>
            <li><a href="namespaceov__msckf.html">ov_msckf</a></li>
            <li><a href="annotated.html">Classes</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="6">
            <li><a href="https://github.com/rpng/open_vins/">GitHub</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespaceov__msckf.html">ov_msckf</a>::<wbr/></span>UpdaterHelper <span class="m-thin">class</span>
        </h1>
        <p>Class that has helper functions for our updaters.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#pub-types">Public types</a></li>
                <li><a href="#pub-static-methods">Public static functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
<p>Can compute the Jacobian for a single feature representation. This will create the Jacobian based on what representation our state is in. If we are using the anchor representation then we also have additional Jacobians in respect to the anchor state. Also has functions such as nullspace projection and full jacobian construction. For derivations look at <a href="update-feat.html" class="m-doc">Camera Measurement Update</a> page which has detailed equations.</p>
        <section id="pub-types">
          <h2><a href="#pub-types">Public types</a></h2>
          <dl class="m-doc">
            <dt>
              struct <a href="structov__msckf_1_1UpdaterHelper_1_1UpdaterHelperFeature.html" class="m-doc">UpdaterHelperFeature</a>
            </dt>
            <dd>Feature object that our <a href="classov__msckf_1_1UpdaterHelper.html" class="m-doc">UpdaterHelper</a> leverages, has all measurements and means.</dd>
          </dl>
        </section>
        <section id="pub-static-methods">
          <h2><a href="#pub-static-methods">Public static functions</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">static void <a href="#a30b351d5fc6a16b1dca935477abc66db" class="m-doc">get_feature_jacobian_representation</a>(</span><span class="m-doc-wrap"><a href="classov__msckf_1_1State.html" class="m-doc">State</a>* state,
              <a href="structov__msckf_1_1UpdaterHelper_1_1UpdaterHelperFeature.html" class="m-doc">UpdaterHelperFeature</a>&amp; feature,
              Eigen::Matrix&lt;double, 3, 3&gt;&amp; H_f,
              std::vector&lt;Eigen::Matrix&lt;double, 3, Eigen::Dynamic&gt;&gt;&amp; H_x,
              std::vector&lt;<a href="classov__core_1_1Type.html" class="m-doc">Type</a>*&gt;&amp; x_order)</span>
            </dt>
            <dd>This gets the feature and state Jacobian in respect to the feature representation.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">static void <a href="#ae83ae1ace0ab3bffdf8030a6efd7b475" class="m-doc">get_feature_jacobian_intrinsics</a>(</span><span class="m-doc-wrap"><a href="classov__msckf_1_1State.html" class="m-doc">State</a>* state,
              const Eigen::Vector2d&amp; uv_norm,
              bool isfisheye,
              Eigen::Matrix&lt;double, 8, 1&gt; cam_d,
              Eigen::Matrix&lt;double, 2, 2&gt;&amp; dz_dzn,
              Eigen::Matrix&lt;double, 2, 8&gt;&amp; dz_dzeta)</span>
            </dt>
            <dd>This will compute the Jacobian in respect to the intrinsic calibration parameters and normalized coordinates.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">static void <a href="#a866dde286826115155ad40fb2066655c" class="m-doc">get_feature_jacobian_full</a>(</span><span class="m-doc-wrap"><a href="classov__msckf_1_1State.html" class="m-doc">State</a>* state,
              <a href="structov__msckf_1_1UpdaterHelper_1_1UpdaterHelperFeature.html" class="m-doc">UpdaterHelperFeature</a>&amp; feature,
              Eigen::MatrixXd&amp; H_f,
              Eigen::MatrixXd&amp; H_x,
              Eigen::VectorXd&amp; res,
              std::vector&lt;<a href="classov__core_1_1Type.html" class="m-doc">Type</a>*&gt;&amp; x_order)</span>
            </dt>
            <dd>Will construct the &quot;stacked&quot; Jacobians for a single feature from all its measurements.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">static void <a href="#a5cbdb9addf936d5cf101a9a9bda79f3b" class="m-doc">nullspace_project_inplace</a>(</span><span class="m-doc-wrap">Eigen::MatrixXd&amp; H_f,
              Eigen::MatrixXd&amp; H_x,
              Eigen::VectorXd&amp; res)</span>
            </dt>
            <dd>This will project the left nullspace of H_f onto the linear system.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">static void <a href="#a45c5fab93318114f765bf29e9e42a3f3" class="m-doc">measurement_compress_inplace</a>(</span><span class="m-doc-wrap">Eigen::MatrixXd&amp; H_x,
              Eigen::VectorXd&amp; res)</span>
            </dt>
            <dd>This will perform measurement compression.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="a30b351d5fc6a16b1dca935477abc66db"><div>
            <h3>
              <span class="m-doc-wrap-bumper">static void ov_msckf::<wbr />UpdaterHelper::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a30b351d5fc6a16b1dca935477abc66db" class="m-doc-self">get_feature_jacobian_representation</a>(</span><span class="m-doc-wrap"><a href="classov__msckf_1_1State.html" class="m-doc">State</a>* state,
              <a href="structov__msckf_1_1UpdaterHelper_1_1UpdaterHelperFeature.html" class="m-doc">UpdaterHelperFeature</a>&amp; feature,
              Eigen::Matrix&lt;double, 3, 3&gt;&amp; H_f,
              std::vector&lt;Eigen::Matrix&lt;double, 3, Eigen::Dynamic&gt;&gt;&amp; H_x,
              std::vector&lt;<a href="classov__core_1_1Type.html" class="m-doc">Type</a>*&gt;&amp; x_order)</span></span>
            </h3>
            <p>This gets the feature and state Jacobian in respect to the feature representation.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">state&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td><a href="classov__msckf_1_1State.html" class="m-doc">State</a> of the filter system</td>
                </tr>
                <tr>
                  <td>feature&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Feature we want to get Jacobians of (must have feature means)</td>
                </tr>
                <tr>
                  <td>H_f&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Jacobians in respect to the feature error state</td>
                </tr>
                <tr>
                  <td>H_x&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Extra Jacobians in respect to the state (for example anchored pose)</td>
                </tr>
                <tr>
                  <td>x_order&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Extra variables our extra Jacobian has (for example anchored pose)</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="ae83ae1ace0ab3bffdf8030a6efd7b475"><div>
            <h3>
              <span class="m-doc-wrap-bumper">static void ov_msckf::<wbr />UpdaterHelper::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#ae83ae1ace0ab3bffdf8030a6efd7b475" class="m-doc-self">get_feature_jacobian_intrinsics</a>(</span><span class="m-doc-wrap"><a href="classov__msckf_1_1State.html" class="m-doc">State</a>* state,
              const Eigen::Vector2d&amp; uv_norm,
              bool isfisheye,
              Eigen::Matrix&lt;double, 8, 1&gt; cam_d,
              Eigen::Matrix&lt;double, 2, 2&gt;&amp; dz_dzn,
              Eigen::Matrix&lt;double, 2, 8&gt;&amp; dz_dzeta)</span></span>
            </h3>
            <p>This will compute the Jacobian in respect to the intrinsic calibration parameters and normalized coordinates.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">state</td>
                  <td><a href="classov__msckf_1_1State.html" class="m-doc">State</a> of the filter system</td>
                </tr>
                <tr>
                  <td>uv_norm</td>
                  <td>Normalized image coordinates</td>
                </tr>
                <tr>
                  <td>isfisheye</td>
                  <td>If this feature is for a fisheye model</td>
                </tr>
                <tr>
                  <td>cam_d</td>
                  <td>Camera intrinsics values</td>
                </tr>
                <tr>
                  <td>dz_dzn</td>
                  <td>Derivative in respect to normalized coordinates</td>
                </tr>
                <tr>
                  <td>dz_dzeta</td>
                  <td>Derivative in respect to distortion paramters</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a866dde286826115155ad40fb2066655c"><div>
            <h3>
              <span class="m-doc-wrap-bumper">static void ov_msckf::<wbr />UpdaterHelper::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a866dde286826115155ad40fb2066655c" class="m-doc-self">get_feature_jacobian_full</a>(</span><span class="m-doc-wrap"><a href="classov__msckf_1_1State.html" class="m-doc">State</a>* state,
              <a href="structov__msckf_1_1UpdaterHelper_1_1UpdaterHelperFeature.html" class="m-doc">UpdaterHelperFeature</a>&amp; feature,
              Eigen::MatrixXd&amp; H_f,
              Eigen::MatrixXd&amp; H_x,
              Eigen::VectorXd&amp; res,
              std::vector&lt;<a href="classov__core_1_1Type.html" class="m-doc">Type</a>*&gt;&amp; x_order)</span></span>
            </h3>
            <p>Will construct the &quot;stacked&quot; Jacobians for a single feature from all its measurements.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">state&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td><a href="classov__msckf_1_1State.html" class="m-doc">State</a> of the filter system</td>
                </tr>
                <tr>
                  <td>feature&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Feature we want to get Jacobians of (must have feature means)</td>
                </tr>
                <tr>
                  <td>H_f&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Jacobians in respect to the feature error state</td>
                </tr>
                <tr>
                  <td>H_x&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Extra Jacobians in respect to the state (for example anchored pose)</td>
                </tr>
                <tr>
                  <td>res&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Measurement residual for this feature</td>
                </tr>
                <tr>
                  <td>x_order&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Extra variables our extra Jacobian has (for example anchored pose)</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a5cbdb9addf936d5cf101a9a9bda79f3b"><div>
            <h3>
              <span class="m-doc-wrap-bumper">static void ov_msckf::<wbr />UpdaterHelper::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a5cbdb9addf936d5cf101a9a9bda79f3b" class="m-doc-self">nullspace_project_inplace</a>(</span><span class="m-doc-wrap">Eigen::MatrixXd&amp; H_f,
              Eigen::MatrixXd&amp; H_x,
              Eigen::VectorXd&amp; res)</span></span>
            </h3>
            <p>This will project the left nullspace of H_f onto the linear system.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">H_f</td>
                  <td>Jacobian with nullspace we want to project onto the system [res = Hx*(x-xhat)+Hf(f-fhat)+n]</td>
                </tr>
                <tr>
                  <td>H_x</td>
                  <td><a href="classov__msckf_1_1State.html" class="m-doc">State</a> jacobian</td>
                </tr>
                <tr>
                  <td>res</td>
                  <td>Measurement residual</td>
                </tr>
              </tbody>
            </table>
<p>Please see the <a href="update-null.html" class="m-doc">MSCKF Nullspace Projection</a> for details on how this works. This is the MSCKF nullspace projection which removes the dependency on the feature state. Note that this is done <strong>in place</strong> so all matrices will be different after a function call.</p>
          </div></section>
          <section class="m-doc-details" id="a45c5fab93318114f765bf29e9e42a3f3"><div>
            <h3>
              <span class="m-doc-wrap-bumper">static void ov_msckf::<wbr />UpdaterHelper::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a45c5fab93318114f765bf29e9e42a3f3" class="m-doc-self">measurement_compress_inplace</a>(</span><span class="m-doc-wrap">Eigen::MatrixXd&amp; H_x,
              Eigen::VectorXd&amp; res)</span></span>
            </h3>
            <p>This will perform measurement compression.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">H_x</td>
                  <td><a href="classov__msckf_1_1State.html" class="m-doc">State</a> jacobian</td>
                </tr>
                <tr>
                  <td>res</td>
                  <td>Measurement residual</td>
                </tr>
              </tbody>
            </table>
<p>Please see the <a href="update-compress.html" class="m-doc">Measurement Compression</a> for details on how this works. Note that this is done <strong>in place</strong> so all matrices will be different after a function call.</p>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Generated by <a href="https://doxygen.org/">Doxygen</a> 1.8.16 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
