<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Getting Started &raquo; Simple Tutorial | OpenVINS</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600&amp;subset=latin-ext" />
  <link rel="stylesheet" href="m-udel+documentation.compiled.css" />
  <link rel="stylesheet" href="custom.css" />
  <link rel="icon" href="favicon-light.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#2f73a3" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">OpenVINS</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="namespaceov__core.html">ov_core</a></li>
            <li><a href="namespaceov__type.html">ov_type</a></li>
            <li><a href="namespaceov__msckf.html">ov_msckf</a></li>
            <li><a href="namespaceov__init.html">ov_init</a></li>
            <li><a href="namespaceov__eval.html">ov_eval</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="8">
            <li><a href="https://github.com/rpng/open_vins/">GitHub</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="getting-started.html">Getting Started</a> &raquo;</span>
          Simple Tutorial
        </h1>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li><a href="#gs-tutorial-ros1">ROS 1 Tutorial</a></li>
            <li><a href="#gs-tutorial-ros2">ROS 2 Tutorial</a></li>
          </ul>
        </div>
<p>This guide assumes that you have already built the project successfully and are now ready to run the program on some datasets. If you have not compiled the program yet please follow the <a href="gs-installing.html" class="m-doc">Installation Guide (ROS1 and ROS2)</a> guide. The first that we will download is a dataset to run the program on. In this tutorial we will run on the <a href="https://projects.asl.ethz.ch/datasets/doku.php?id=kmavvisualinertialdatasets">EuRoC MAV Dataset</a> <a href="citelist.html#CITEREF_Burri2016IJRR" class="m-doc">[4]</a> which provides monochrome stereo images at 20Hz with a MEMS ADIS16448 IMU at 200Hz.</p><div class="m-col-m-6 m-button m-primary"><a href="http://robotics.ethz.ch/~asl-datasets/ijrr_euroc_mav_dataset/vicon_room1/V1_01_easy/V1_01_easy.bag"><div class="m-big">Download ROS 1 Bag</div>  <div class="m-small">Vicon Room 1 01 Easy</div></a></div><div class="m-col-m-6 m-button m-primary"><a href="https://drive.google.com/drive/folders/1xQ1KcZhZ5pioPXTyrZBN6Mjxkfpcd_B3?usp=sharing"><div class="m-big">Download ROS 2 Bag</div>  <div class="m-small">Vicon Room 1 01 Easy</div></a></div><p>All configuration information for the system is exposed to the user in the configuration file, and can be overridden in the launch file. We will create a launch file that will launch our MSCKF estimation node and feed the ROS bag into the system. One can take a look in the <a href="https://github.com/rpng/open_vins/tree/master/ov_msckf/launch">launch</a> folder for more examples. For OpenVINS we need to define a series of files:</p><ul><li><code>estimator_config.yaml</code> - Contains OpenVINS specific configuration files. Each of these can be overridden in the launch file.</li><li><code>kalibr_imu_chain.yaml</code> - IMU noise parameters and topic information based on the sensor in the dataset. This should be the same as Kalibr&#x27;s (see <a href="gs-calibration.html#gs-calib-imu-static" class="m-doc">IMU Noise Calibration (Offline)</a>).</li><li><code>kalibr_imucam_chain.yaml</code> - Camera to IMU transformation and camera intrinsics. This should be the same as Kalibr&#x27;s (see <a href="gs-calibration.html#gs-calib-cam-static" class="m-doc">Camera Intrinsic Calibration (Offline)</a>).</li></ul><section id="gs-tutorial-ros1"><h2><a href="#gs-tutorial-ros1">ROS 1 Tutorial</a></h2><p>The ROS1 system uses the <a href="http://wiki.ros.org/roslaunch">roslaunch</a> system to manage and launch nodes. These files can launch multiple nodes, and each node can their own set of parameters set. Consider the below launch file. We can see the main parameter that is being passed into the estimator is the <code>config_path</code> file which has all configuration for this specific dataset. Additionally, we can see that we are launching the <code>run_subscribe_msckf</code> ROS 1 node, and are going to be overriding the <code>use_stereo</code> and <code>max_cameras</code> with the specificed values. ROS parameters always have priority, and you should see in the console that they have been successfully overridden.</p><div class="m-container-inflate"><pre class="m-code"><span class="nt">&lt;launch&gt;</span>

    <span class="c">&lt;!-- what config we are going to run (should match folder name) --&gt;</span>
    <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;verbosity&quot;</span>   <span class="na">default=</span><span class="s">&quot;INFO&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- ALL, DEBUG, INFO, WARNING, ERROR, SILENT --&gt;</span>
    <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;config&quot;</span>      <span class="na">default=</span><span class="s">&quot;euroc_mav&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- euroc_mav, tum_vi, rpng_aruco --&gt;</span>
    <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;config_path&quot;</span> <span class="na">default=</span><span class="s">&quot;$(find ov_msckf)/../config/$(arg config)/estimator_config.yaml&quot;</span> <span class="nt">/&gt;</span>

    <span class="c">&lt;!-- MASTER NODE! --&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;run_subscribe_msckf&quot;</span> <span class="na">pkg=</span><span class="s">&quot;ov_msckf&quot;</span> <span class="na">type=</span><span class="s">&quot;run_subscribe_msckf&quot;</span> <span class="na">output=</span><span class="s">&quot;screen&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;verbosity&quot;</span>    <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;$(arg verbosity)&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;config_path&quot;</span>  <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;$(arg config_path)&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;use_stereo&quot;</span>   <span class="na">type=</span><span class="s">&quot;bool&quot;</span>   <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;max_cameras&quot;</span>  <span class="na">type=</span><span class="s">&quot;int&quot;</span>    <span class="na">value=</span><span class="s">&quot;2&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/node&gt;</span>

<span class="nt">&lt;/launch&gt;</span></pre></div><p>Since the configuration file for the EurocMav dataset has already been created, we can simply do the following. Note it is good practice to run a <code>roscore</code> that stays active so that you do not need to relaunch rviz or other packages.</p><pre class="m-console"><span class="go">roscore # term 0</span>
<span class="go">source devel/setup.bash # term 1</span>
<span class="go">roslaunch ov_msckf subscribe.launch config:=euroc_mav</span></pre><p>In another two terminals we can run the following. For RVIZ, one can open the <code>ov_msckf/launch/display.rviz</code> configuration file. You should see the system publishing features and a state estimate.</p><pre class="m-console"><span class="go">rviz # term 2</span>
<span class="go">rosbag play V1_01_easy.bag # term 3</span></pre></section><section id="gs-tutorial-ros2"><h2><a href="#gs-tutorial-ros2">ROS 2 Tutorial</a></h2><p>For ROS 2, launch files and nodes have become a bit more combersom due to the removal of a centralized communication method. This both allows for more distributed systems, but causes a bit more on the developer to perform integration. The launch system is described in <a href="https://design.ros2.org/articles/roslaunch.html">this</a> design article. Consider the following launch file which does the same as the ROS 1 launch file above.</p><div class="m-container-inflate"><pre class="m-code"><span class="kn">from</span> <span class="nn">launch</span> <span class="kn">import</span> <span class="n">LaunchDescription</span>
<span class="kn">from</span> <span class="nn">launch.actions</span> <span class="kn">import</span> <span class="n">DeclareLaunchArgument</span><span class="p">,</span> <span class="n">LogInfo</span><span class="p">,</span> <span class="n">OpaqueFunction</span>
<span class="kn">from</span> <span class="nn">launch.conditions</span> <span class="kn">import</span> <span class="n">IfCondition</span>
<span class="kn">from</span> <span class="nn">launch.substitutions</span> <span class="kn">import</span> <span class="n">LaunchConfiguration</span><span class="p">,</span> <span class="n">TextSubstitution</span>
<span class="kn">from</span> <span class="nn">launch_ros.actions</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">ament_index_python.packages</span> <span class="kn">import</span> <span class="n">get_package_share_directory</span><span class="p">,</span> <span class="n">get_package_prefix</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">launch_args</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DeclareLaunchArgument</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;namespace&#39;</span><span class="p">,</span>         <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>           <span class="n">description</span><span class="o">=</span><span class="s1">&#39;namespace&#39;</span><span class="p">),</span>
    <span class="n">DeclareLaunchArgument</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;config&#39;</span><span class="p">,</span>            <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;euroc_mav&#39;</span><span class="p">,</span>  <span class="n">description</span><span class="o">=</span><span class="s1">&#39;euroc_mav, tum_vi, rpng_aruco...&#39;</span><span class="p">),</span>
    <span class="n">DeclareLaunchArgument</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;verbosity&#39;</span><span class="p">,</span>         <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">,</span>       <span class="n">description</span><span class="o">=</span><span class="s1">&#39;ALL, DEBUG, INFO, WARNING, ERROR, SILENT&#39;</span><span class="p">),</span>
    <span class="n">DeclareLaunchArgument</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;use_stereo&#39;</span><span class="p">,</span>        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>       <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="n">DeclareLaunchArgument</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;max_cameras&#39;</span><span class="p">,</span>       <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span>          <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="p">]</span>

<span class="k">def</span> <span class="nf">launch_setup</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="n">configs_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_package_share_directory</span><span class="p">(</span><span class="s1">&#39;ov_msckf&#39;</span><span class="p">),</span><span class="s1">&#39;config&#39;</span><span class="p">)</span>
    <span class="n">available_configs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">configs_dir</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">available_configs</span><span class="p">:</span>
        <span class="k">return</span><span class="p">[</span><span class="n">LogInfo</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;ERROR: unknown config: </span><span class="se">\&#39;</span><span class="s1">{}</span><span class="se">\&#39;</span><span class="s1"> - Available configs are: {} - not starting OpenVINS&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">available_configs</span><span class="p">)))]</span>
    <span class="n">config_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_package_share_directory</span><span class="p">(</span><span class="s1">&#39;ov_msckf&#39;</span><span class="p">),</span><span class="s1">&#39;config&#39;</span><span class="p">,</span><span class="n">config</span><span class="p">,</span><span class="s1">&#39;estimator_config.yaml&#39;</span><span class="p">)</span>
    <span class="n">node1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">package</span> <span class="o">=</span> <span class="s1">&#39;ov_msckf&#39;</span><span class="p">,</span>
                 <span class="n">executable</span> <span class="o">=</span> <span class="s1">&#39;run_subscribe_msckf&#39;</span><span class="p">,</span>
                 <span class="n">namespace</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;namespace&#39;</span><span class="p">),</span>
                 <span class="n">parameters</span> <span class="o">=</span><span class="p">[{</span><span class="s1">&#39;verbosity&#39;</span><span class="p">:</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;verbosity&#39;</span><span class="p">)},</span>
                              <span class="p">{</span><span class="s1">&#39;use_stereo&#39;</span><span class="p">:</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;use_stereo&#39;</span><span class="p">)},</span>
                              <span class="p">{</span><span class="s1">&#39;max_cameras&#39;</span><span class="p">:</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="s1">&#39;max_cameras&#39;</span><span class="p">)},</span>
                              <span class="p">{</span><span class="s1">&#39;config_path&#39;</span><span class="p">:</span> <span class="n">config_path</span><span class="p">}])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">node1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">generate_launch_description</span><span class="p">():</span>
    <span class="n">opfunc</span> <span class="o">=</span> <span class="n">OpaqueFunction</span><span class="p">(</span><span class="n">function</span> <span class="o">=</span> <span class="n">launch_setup</span><span class="p">)</span>
    <span class="n">ld</span> <span class="o">=</span> <span class="n">LaunchDescription</span><span class="p">(</span><span class="n">launch_args</span><span class="p">)</span>
    <span class="n">ld</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span><span class="n">opfunc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ld</span></pre></div><p>We can see that first the <code>launch_setup</code> function defines the nodes that we will be launching from this file. Then the <code>LaunchDescription</code> is created given the launch arguments and the node is added to it and returned to ROS. We can the launch it using the following:</p><pre class="m-console"><span class="go">source install/setup.bash</span>
<span class="go">ros2 launch ov_msckf subscribe.launch.py config:=euroc_mav</span></pre><p>We can then use the ROS2 rosbag file. First make sure you have installed the rosbag2 and all its backends. If you downloaded the bag above you should already have a valid bag format. Otherwise, you will need to convert it following <a href="dev-ros1-to-ros2.html" class="m-doc">ROS1 to ROS2 Bag Conversion Guide</a> . A &quot;bag&quot; is now defined by a db3 sqlite database and config yaml file in a folder. In another terminal we can run the following:</p><pre class="m-console"><span class="go">ros2 bag play V1_01_easy</span></pre></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Generated by <a href="https://doxygen.org/">Doxygen</a> 1.8.20 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
